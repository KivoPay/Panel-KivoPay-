<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>KivoPay ‚Ä¢ Aplikasi Premium</title>
  <style>
    :root{
      --bg:#070a12;
      --card:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.10);
      --text:#eaf0ff;
      --muted:#aeb9d6;
      --accent:#6ea8fe;
      --good:#3ddc97;
      --bad:#ff5b5b;
      --shadow: 0 14px 40px rgba(0,0,0,.35);
      --r:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(900px 400px at 10% 10%,rgba(110,168,254,.18),transparent 55%),
        radial-gradient(800px 420px at 90% 20%,rgba(61,220,151,.12),transparent 55%),
        radial-gradient(600px 320px at 40% 90%,rgba(255,91,91,.10),transparent 55%),
        var(--bg);
      min-height:100vh;
    }
    a{color:inherit}
    .wrap{max-width:1100px;margin:0 auto;padding:18px 14px 90px}
    .topbar{
      position:sticky; top:0; z-index:99;
      backdrop-filter: blur(10px);
      background: rgba(7,10,18,.65);
      border-bottom:1px solid var(--border);
    }
    .topbar .in{max-width:1100px;margin:0 auto;padding:12px 14px;display:flex;gap:12px;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px}
    .brand .logo{
      width:40px;height:40px;border-radius:12px;
      background:linear-gradient(135deg, rgba(110,168,254,.75), rgba(61,220,151,.45));
      display:grid;place-items:center;box-shadow:var(--shadow);
      border:1px solid rgba(255,255,255,.08);
      font-weight:900;
    }
    .brand .t{display:flex;flex-direction:column;line-height:1.1}
    .brand .t b{font-size:14px}
    .brand .t span{font-size:12px;color:var(--muted)}
    .right{display:flex;gap:10px;align-items:center}
    .pill{
      display:flex;gap:8px;align-items:center;
      padding:9px 12px;border:1px solid var(--border);
      border-radius:999px;background:rgba(255,255,255,.04);
      box-shadow: 0 10px 24px rgba(0,0,0,.20);
      font-size:12px;color:var(--muted);
      user-select:none;
    }
    .dot{
      width:9px;height:9px;border-radius:999px;
      background:var(--bad);
      box-shadow: 0 0 0 0 rgba(255,91,91,.55);
      animation:pulse 1.4s infinite;
    }
    .dot.on{
      background:var(--good);
      box-shadow: 0 0 0 0 rgba(61,220,151,.55);
    }
    @keyframes pulse{
      0%{box-shadow:0 0 0 0 rgba(255,91,91,.55)}
      70%{box-shadow:0 0 0 10px rgba(255,91,91,0)}
      100%{box-shadow:0 0 0 0 rgba(255,91,91,0)}
    }
    .dot.on{ animation: pulseOn 1.4s infinite; }
    @keyframes pulseOn{
      0%{box-shadow:0 0 0 0 rgba(61,220,151,.55)}
      70%{box-shadow:0 0 0 10px rgba(61,220,151,0)}
      100%{box-shadow:0 0 0 0 rgba(61,220,151,0)}
    }

    .btn{
      appearance:none;border:0;cursor:pointer;
      padding:10px 14px;border-radius:14px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--border);
      color:var(--text);
      box-shadow: 0 14px 26px rgba(0,0,0,.25);
      transition:.18s transform, .18s filter, .18s background;
      font-weight:600;
    }
    .btn:hover{transform:translateY(-1px);filter:brightness(1.05)}
    .btn.primary{
      background:linear-gradient(135deg, rgba(110,168,254,.95), rgba(110,168,254,.55));
      border-color:rgba(110,168,254,.35);
    }
    .btn.ghost{
      background:transparent;
    }
    .btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
    .hero{
      margin-top:14px;
      display:flex;gap:14px;flex-wrap:wrap;align-items:stretch;
    }
    .heroCard{
      flex:1 1 420px;
      border:1px solid var(--border);
      border-radius:24px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow:var(--shadow);
      padding:18px;
      position:relative;
      overflow:hidden;
    }
    .heroCard:before{
      content:"";
      position:absolute; inset:-120px -120px auto auto;
      width:260px;height:260px;border-radius:999px;
      background: radial-gradient(circle at 30% 30%, rgba(110,168,254,.35), transparent 60%);
      filter: blur(2px);
      transform:rotate(10deg);
    }
    .typing{
      font-size:18px;
      line-height:1.35;
      color:var(--text);
      margin:2px 0 10px;
      min-height:48px;
    }
    .typing small{display:block;color:var(--muted);margin-top:6px}
    .searchRow{display:flex;gap:10px;align-items:center;margin-top:12px}
    .search{
      flex:1;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.20);
      color:var(--text);
      outline:none;
      font-size:14px;
    }
    .sectionHead{
      margin:22px 0 10px;
      display:flex;align-items:flex-end;justify-content:space-between;gap:10px;flex-wrap:wrap;
    }
    .sectionHead h2{margin:0;font-size:18px}
    .sectionHead p{margin:0;color:var(--muted);font-size:13px}

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:14px;
      margin-top:12px;
    }
    @media (min-width: 920px){
      .grid{grid-template-columns: repeat(3, minmax(0,1fr));}
    }
    .card{
      border:1px solid var(--border);
      background:rgba(255,255,255,.05);
      border-radius:22px;
      overflow:hidden;
      box-shadow: 0 16px 35px rgba(0,0,0,.28);
      position:relative;
    }
    .thumb{
      aspect-ratio: 16/10;
      background:rgba(0,0,0,.35);
      display:block;
      width:100%;
      object-fit:cover;
    }
    .card .c{
      padding:12px 12px 14px;
      display:flexjc: display:flex;
      flex-direction:column; gap:8px;
    }
    .card h3{margin:0;font-size:15px}
    .muted{color:var(--muted);font-size:12.5px}
    .priceRow{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:6px}
    .price{font-weight:800;color:rgba(110,168,254,.95)}
    .tag{
      font-size:11px;color:rgba(255,255,255,.85);
      padding:7px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      width:fit-content;
    }

    /* MODAL */
    .backdrop{
      position:fixed; inset:0; z-index:200;
      background: rgba(0,0,0,.55);
      display:none; align-items:flex-end; justify-content:center;
      padding:16px;
    }
    .backdrop.show{display:flex}
    .modal{
      width:min(920px, 100%);
      border:1px solid var(--border);
      background:rgba(10,14,26,.92);
      border-radius:26px;
      box-shadow: 0 26px 80px rgba(0,0,0,.55);
      overflow:hidden;
    }
    .mHead{
      padding:14px 14px;
      display:flex;justify-content:space-between;align-items:center;gap:10px;
      border-bottom:1px solid var(--border);
      background:rgba(255,255,255,.03);
    }
    .mHead b{font-size:14px}
    .mBody{padding:14px}
    .cols{display:grid;grid-template-columns:1fr;gap:14px}
    @media (min-width: 820px){ .cols{grid-template-columns:1.2fr .8fr;} }
    .box{
      border:1px solid var(--border);
      border-radius:20px;
      background:rgba(255,255,255,.04);
      padding:12px;
    }
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .field{flex:1 1 160px;display:flex;flex-direction:column;gap:6px}
    .field label{font-size:12px;color:var(--muted)}
    .field input, .field select{
      padding:12px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      color:var(--text);
      outline:none;
    }
    .payOpt{display:flex;gap:10px;flex-wrap:wrap}
    .payBtn{
      flex:1 1 160px;
      display:flex;align-items:center;gap:10px;
      border-radius:18px;
      padding:12px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      cursor:pointer;
      transition:.18s transform,.18s filter;
      user-select:none;
    }
    .payBtn:hover{transform:translateY(-1px);filter:brightness(1.05)}
    .payBtn.active{border-color:rgba(110,168,254,.45); box-shadow:0 0 0 2px rgba(110,168,254,.12) inset}
    .payBtn img{width:34px;height:34px;border-radius:10px;object-fit:cover}
    .qrisBig{
      display:none;
      margin-top:10px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      padding:10px;
      text-align:center;
    }
    .qrisBig.show{display:block}
    .qrisBig img{max-width:320px;width:100%;border-radius:14px}
    .qrisBig .hint{font-size:12px;color:var(--muted);margin-top:6px}
    .total{
      display:flex;justify-content:space-between;align-items:center;
      font-size:14px;
    }
    .total b{font-size:18px;color:rgba(110,168,254,.95)}
    .sep{height:1px;background:rgba(255,255,255,.10);margin:10px 0}
    .notice{
      font-size:12.5px;color:var(--muted);line-height:1.35
    }

    /* LOGIN MODAL */
    .miniLink{color:rgba(110,168,254,.95);cursor:pointer;text-decoration:underline}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="in">
      <div class="brand">
        <div class="logo">K</div>
        <div class="t">
          <b>KivoPay</b>
          <span>Aplikasi Premium ‚Ä¢ Order via WhatsApp</span>
        </div>
      </div>

      <div class="right">
        <div class="pill" id="adminPill" title="Status admin otomatis">
          <span class="dot" id="adminDot"></span>
          <span id="adminText">Offline</span>
          <span style="opacity:.7">‚Ä¢</span>
          <span id="adminWindow">16:30‚Äì22:30</span>
        </div>
        <button class="btn" id="btnLogin">Login</button>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="hero">
      <div class="heroCard">
        <div class="typing" id="typing"></div>
        <div class="searchRow">
          <input class="search" id="search" placeholder="Cari produk... (contoh: Netflix, Canva, Capcut)" />
          <button class="btn primary" id="btnClear">Reset</button>
        </div>
        <div style="margin-top:10px" class="muted">
          Klik <b>Pesan</b> ‚Üí pilih paket ‚Üí bayar ‚Üí klik <b>Saya sudah bayar</b> ‚Üí baru bisa <b>Chat Admin</b>.
        </div>
      </div>
    </div>

    <div class="sectionHead">
      <div>
        <h2>Kategori: Aplikasi Premium</h2>
        <p>Klik Pesan untuk pilih paket & bayar</p>
      </div>
      <div class="muted"><span id="count">0</span> produk</div>
    </div>

    <div class="grid" id="grid"></div>
  </div>

  <!-- MODAL ORDER -->
  <div class="backdrop" id="bdOrder" aria-hidden="true">
    <div class="modal">
      <div class="mHead">
        <div>
          <b id="mTitle">Pesan Produk</b>
          <div class="muted" id="mSub">Pilih paket & isi data buyer</div>
        </div>
        <button class="btn ghost" id="mClose">Tutup</button>
      </div>
      <div class="mBody">
        <div class="cols">
          <div class="box">
            <div class="row">
              <div class="field">
                <label>Nama</label>
                <input id="fName" placeholder="Nama kamu"/>
              </div>
              <div class="field">
                <label>WhatsApp</label>
                <input id="fWa" placeholder="08xxxxxxxxxx"/>
              </div>
              <div class="field">
                <label>Email Buyer</label>
                <input id="fEmail" placeholder="email@example.com"/>
              </div>
            </div>

            <div class="row" style="margin-top:10px">
              <div class="field" style="flex:1 1 260px">
                <label>Pilih Durasi / Paket</label>
                <select id="fVariant"></select>
              </div>
              <div class="field">
                <label>Lokasi</label>
                <input id="fLoc" placeholder="contoh: Indonesia"/>
              </div>
            </div>

            <div class="sep"></div>

            <div class="total">
              <div class="muted">Total bayar</div>
              <b id="total">Rp 0</b>
            </div>

            <div class="notice" style="margin-top:8px">
              Setelah transfer / scan QRIS, klik tombol <b>Saya sudah bayar</b>. Baru tombol <b>Chat Admin</b> kebuka.
            </div>
          </div>

          <div class="box">
            <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
              <b style="font-size:14px">Metode Pembayaran</b>
              <span class="tag" id="payState">Belum dibayar</span>
            </div>

            <div class="payOpt" style="margin-top:10px">
              <div class="payBtn" data-pay="dana">
                <img src="https://images.bukaolshop.com/hosting/181218/f2f4904ff62a785161.png" alt="Dana"/>
                <div>
                  <div style="font-weight:700">Dana</div>
                  <div class="muted">087753513090</div>
                </div>
              </div>
              <div class="payBtn" data-pay="seabank">
                <img src="https://images.bukaolshop.com/hosting/181218/0d46bd2ba133491753.png" alt="SeaBank"/>
                <div>
                  <div style="font-weight:700">SeaBank</div>
                  <div class="muted">901517870612</div>
                </div>
              </div>
              <div class="payBtn" data-pay="qris">
                <img src="https://images.bukaolshop.com/hosting/181218/111e83c3a6f5204498.png" alt="QRIS"/>
                <div>
                  <div style="font-weight:700">QRIS</div>
                  <div class="muted">Tampilkan QR üëÅÔ∏è</div>
                </div>
              </div>
            </div>

            <div class="qrisBig" id="qrisBox">
              <img src="https://images.bukaolshop.com/hosting/181218/cce817858ef1663896.png" alt="QRIS"/>
              <div class="hint">Scan QRIS di atas, lalu kembali dan klik ‚ÄúSaya sudah bayar‚Äù.</div>
            </div>

            <div class="sep"></div>

            <button class="btn primary" id="btnPaid">Saya sudah bayar</button>
            <div style="height:10px"></div>
            <button class="btn" id="btnChat" disabled>Chat Admin (kirim order)</button>
            <div class="notice" style="margin-top:10px">
              Admin WhatsApp: <span class="miniLink" id="adminLink">wa.me/6285150895395</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL LOGIN -->
  <div class="backdrop" id="bdLogin" aria-hidden="true">
    <div class="modal" style="max-width:620px">
      <div class="mHead">
        <div>
          <b id="lTitle">Login</b>
          <div class="muted" id="lSub">Masuk dulu biar data order auto keisi</div>
        </div>
        <button class="btn ghost" id="lClose">Tutup</button>
      </div>
      <div class="mBody">
        <div class="box">
          <div class="row">
            <div class="field">
              <label>Nama</label>
              <input id="lName" placeholder="Nama kamu"/>
            </div>
            <div class="field">
              <label>WhatsApp</label>
              <input id="lWa" placeholder="08xxxxxxxxxx"/>
            </div>
          </div>
          <div class="row" style="margin-top:10px">
            <div class="field">
              <label>Password</label>
              <input id="lPass" type="password" placeholder="Password"/>
            </div>
          </div>
          <div class="sep"></div>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn primary" id="btnDoLogin">Login / Daftar</button>
            <button class="btn" id="btnLogout" style="display:none">Logout</button>
          </div>
          <div class="notice" style="margin-top:10px">
            *Ini sistem login simple (localStorage). Kalau mau login beneran pakai database, itu butuh backend.
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // =======================
  // CONFIG
  // =======================
  const ADMIN_WA = "6285150895395"; // tanpa +
  const ADMIN_WA_LINK = "https://wa.me/" + ADMIN_WA;
// =======================
  // DATA PRODUK
  // =======================
  const products = [
    { name:"Alight Motion Premium", img:"https://images.bukaolshop.com/hosting/181218/4a04b8d7e542788237.png",
      variants:[{label:"Private Akun 1 Tahun", price:9600}] },

    { name:"Prime Video", img:"https://images.bukaolshop.com/hosting/181218/ad8345f7b9c8953792.png",
      variants:[{label:"Shared 1 Bulan", price:6700},{label:"Private 1 Bulan", price:15300}] },

    { name:"Bstation Premium", img:"https://images.bukaolshop.com/hosting/181218/8a64287f1e0d26389.png",
      variants:[{label:"Akun Shared 3 Bulan", price:13300},{label:"Akun Private 1 Bulan", price:25300},{label:"Akun Private 2 Bulan", price:40300}] },

    { name:"Canva Pro Premium", img:"https://images.bukaolshop.com/hosting/181218/fc56c689cb9f975773.png",
      variants:[{label:"Member 7 Hari", price:100},{label:"Member 1 Bulan", price:700},{label:"Member 3 Bulan", price:2500},{label:"Edu lifetime", price:10300}] },

    { name:"Capcut Pro Premium", img:"https://images.bukaolshop.com/hosting/181218/47f862f5ed4a892435.png",
      variants:[{label:"Private Akun 1 Bulan Gar 7h", price:11300},{label:"Private Akun 1 Bulan Gar 28h", price:20300}] },

    { name:"ChatGpt Premium", img:"https://images.bukaolshop.com/hosting/181218/26f804d66e6e88158.png",
      variants:[
        {label:"Member Plan 1 Bulan Private", price:25700},
        {label:"Owner Business Plan 1 Bulan", price:84300},
        {label:"Plus Plan 1 Bulan Private", price:20300},
        {label:"Plus Plan 1 Bulan Private (2)", price:30500},
      ] },

    { name:"IQIYI Premium", img:"https://images.bukaolshop.com/hosting/181218/891f9cc79330873789.png",
      variants:[{label:"Iqiyi Premium 1 Bulan Shared", price:15300},{label:"Iqiyi Premium 1 Bulan Shared 2 Devices", price:23500}] },

    { name:"Video Premium", img:"https://images.bukaolshop.com/hosting/181218/1174d76c8ed6103972.png",
      variants:[{label:"Shared 1 Bulan 2 User Mobile", price:18800},{label:"Private 1 Bulan Khusus Mobile", price:32400}] },

    { name:"Vision+ Premium", img:"https://images.bukaolshop.com/hosting/181218/072f4a242c47628279.png",
      variants:[{label:"Private Akun 1 Bulan All Screen", price:30000}] },

    { name:"Viu Premium", img:"https://images.bukaolshop.com/hosting/181218/e185c3b3935534665.png",
      variants:[{label:"Private 3 Bulan 1 Device", price:7000},{label:"Private 6 Bulan 1 Device", price:8600}] },

    { name:"Wetv Premium", img:"https://images.bukaolshop.com/hosting/181218/9639c4484b80226918.png",
      variants:[{label:"Wetv Premium 1 Bulan Shared", price:13600},{label:"Wetv Premium 1 Bulan Private", price:35300}] },

    { name:"YouTube Premium", img:"https://images.bukaolshop.com/hosting/181218/e1b9eae8982d985428.png",
      variants:[{label:"Anggota Family Plan 1 Bulan Invited", price:8300}] },

    { name:"Lok Lok Premium", img:"https://images.bukaolshop.com/hosting/181218/281994f16dd4975145.png",
      variants:[
        {label:"Sharing 1 Bulan 3 User", price:20300},
        {label:"Sharing 1 Bulan 5 User", price:25300},
        {label:"Private 1 Bulan Basic", price:55300},
        {label:"Private 1 Bulan Standar", price:80000},
      ] },

    { name:"Wink Premium", img:"https://images.bukaolshop.com/hosting/181218/1bcea869e27c407235.png",
      variants:[{label:"Private 7 Day acc b", price:8300},{label:"Private 7 Day acc s", price:12300}] },

    // ‚úÖ NETFLIX
    { name:"Netflix Premium", img:"https://images.bukaolshop.com/hosting/181218/e97361a0f1be36831.png",
      variants:[
        {label:"Sharing 1p1u 7 Day", price:18000},
        {label:"Sharing 1p1u 1 Bulan", price:31000},
        {label:"Sharing 1p2u 7 Day", price:17000},
        {label:"Sharing 1p2u 1 Bulan", price:27000},
        {label:"Private Akun 1 Bulan", price:200000},
      ] },
  ];

  // =======================
  // HELPERS
  // =======================
  const rupiah = (n) => "Rp " + (Number(n)||0).toLocaleString("id-ID");
  const qs = (s) => document.querySelector(s);
  const qsa = (s) => Array.from(document.querySelectorAll(s));

  // =======================
  // ADMIN STATUS (16:30 - 22:30)
  // =======================
  function isAdminOnline(){
    const now = new Date();
    const h = now.getHours(), m = now.getMinutes();
    const mins = h*60+m;
    const start = 16*60+30;
    const end   = 22*60+30;
    return mins >= start && mins < end;
  }
  function renderAdminStatus(){
    const on = isAdminOnline();
    qs("#adminDot").classList.toggle("on", on);
    qs("#adminText").textContent = on ? "Ready" : "Offline";
  }
  setInterval(renderAdminStatus, 15*1000);
  renderAdminStatus();

  // =======================
  // LOGIN (localStorage)
  // =======================
  const LS_KEY = "kivopay_user";
  function getUser(){
    try{ return JSON.parse(localStorage.getItem(LS_KEY)||"null"); }catch(e){ return null; }
  }
  function setUser(u){ localStorage.setItem(LS_KEY, JSON.stringify(u)); }
  function clearUser(){ localStorage.removeItem(LS_KEY); }

  function refreshLoginUI(){
    const u = getUser();
    const btn = qs("#btnLogin");
    if(u){
      btn.textContent = u.name ? ("Hi, " + u.name.split(" ")[0]) : "Akun";
    }else{
      btn.textContent = "Login";
    }
  }
  refreshLoginUI();

  // =======================
  // RENDER PRODUCTS
  // =======================
  const grid = qs("#grid");
  const count = qs("#count");

  function minPrice(p){
    return Math.min(...p.variants.map(v=>v.price));
  }

  function render(list){
    grid.innerHTML = "";
    count.textContent = list.length;
    list.forEach((p, idx)=>{
      const el = document.createElement("div");
      el.className = "card";
      el.innerHTML = `
        <img class="thumb" src="${p.img}" alt="${p.name}">
        <div class="c">
          <h3>${p.name}</h3>
          <div class="muted">Klik Pesan untuk pilih paket & checkout</div>
          <div class="priceRow">
            <div class="price">Mulai ${rupiah(minPrice(p))}</div>
            <button class="btn primary" data-idx="${idx}">Pesan</button>
          </div>
        </div>
      `;
      grid.appendChild(el);
    });

    qsa("button[data-idx]").forEach((b)=>{
      b.addEventListener("click", ()=>{
        const i = Number(b.getAttribute("data-idx"));
        // idx pada list, cari produk by name agar aman saat filter
        openOrder(list[i]);
      });
    });
  }
  render(products);

  // search
  qs("#search").addEventListener("input", (e)=>{
    const q = e.target.value.trim().toLowerCase();
    const filtered = products.filter(p=>p.name.toLowerCase().includes(q));
    render(filtered);
  });
  qs("#btnClear").addEventListener("click", ()=>{
    qs("#search").value = "";
    render(products);
  });

  // =======================
  // ORDER MODAL
  // =======================
  let currentProduct = null;
  let paid = false;
  let payMethod = "dana";

  function openOrder(p){
    currentProduct = p;
    paid = false;
    payMethod = "dana";

    qs("#mTitle").textContent = "Pesan: " + p.name;
    qs("#mSub").textContent = "Pilih paket & isi data buyer";
    qs("#payState").textContent = "Belum dibayar";
    qs("#btnChat").disabled = true;

    // prefill from login
    const u = getUser();
    qs("#fName").value  = u?.name || "";
    qs("#fWa").value    = u?.wa || "";
    qs("#fEmail").value = "";
    qs("#fLoc").value   = "";

    const sel = qs("#fVariant");
    sel.innerHTML = "";
    p.variants.forEach((v,i)=>{
      const opt = document.createElement("option");
      opt.value = i;
      opt.textContent = `${v.label} ‚Äî ${rupiah(v.price)}`;
      sel.appendChild(opt);
    });

    updateTotal();

    // reset pay buttons
    qsa(".payBtn").forEach(x=>x.classList.remove("active"));
    qsa('.payBtn[data-pay="dana"]')[0].classList.add("active");
    qs("#qrisBox").classList.remove("show");

    qs("#bdOrder").classList.add("show");
  }

  function closeOrder(){
    qs("#bdOrder").classList.remove("show");
  }

  function updateTotal(){
    const v = currentProduct.variants[Number(qs("#fVariant").value||0)];
    qs("#total").textContent = rupiah(v.price);
  }

  qs("#fVariant").addEventListener("change", updateTotal);
  qs("#mClose").addEventListener("click", closeOrder);
  qs("#bdOrder").addEventListener("click", (e)=>{
    if(e.target.id === "bdOrder") closeOrder();
  });

  // payment select
  qsa(".payBtn").forEach((btn)=>{
    btn.addEventListener("click", ()=>{
      qsa(".payBtn").forEach(x=>x.classList.remove("active"));
      btn.classList.add("active");
      payMethod = btn.getAttribute("data-pay");

      if(payMethod === "qris"){
        qs("#qrisBox").classList.add("show");
      }else{
        qs("#qrisBox").classList.remove("show");
      }
    });
  });

  // mark as paid
  qs("#btnPaid").addEventListener("click", ()=>{
    paid = true;
    qs("#payState").textContent = "Sudah dibayar";
    qs("#btnChat").disabled = false;
    qs("#btnChat").classList.add("primary");
  });

  // chat admin
  qs("#btnChat").addEventListener("click", ()=>{
    if(!paid) return;

    const name = qs("#fName").value.trim();
    const wa   = qs("#fWa").value.trim();
    const email= qs("#fEmail").value.trim();
    const loc  = qs("#fLoc").value.trim();
    const variant = currentProduct.variants[Number(qs("#fVariant").value||0)];
    const total = variant.price;

    if(!name || !wa){
      alert("Isi Nama & WhatsApp dulu ya.");
      return;
    }

    const payText = (payMethod==="dana" ? "Dana 087753513090" :
                    payMethod==="seabank" ? "SeaBank 901517870612" :
                    "QRIS (scan)");

    const msg =
`Format Orderan KivoPay ‚ú®
Nama : ${name}
WhatsApp : ${wa}
Produk : ${currentProduct.name}
Durasi & Device Buyer : ${variant.label}
Email Buyer : ${email || "-"}
Lokasi : ${loc || "-"}

Metode Bayar : ${payText}
Total : ${rupiah(total)}

Tolong Di Proses Secepatnya Ya Kak üôè`;

    const url = ADMIN_WA_LINK + "?text=" + encodeURIComponent(msg);
    window.open(url, "_blank");
  });

  qs("#adminLink").addEventListener("click", ()=> window.open(ADMIN_WA_LINK, "_blank"));

  // =======================
  // LOGIN MODAL
  // =======================
  function openLogin(){
    const u = getUser();
    qs("#lName").value = u?.name || "";
    qs("#lWa").value   = u?.wa || "";
    qs("#lPass").value = "";
    qs("#btnLogout").style.display = u ? "inline-block" : "none";
    qs("#bdLogin").classList.add("show");
  }
  function closeLogin(){ qs("#bdLogin").classList.remove("show"); }
  qs("#btnLogin").addEventListener("click", openLogin);
  qs("#lClose").addEventListener("click", closeLogin);
  qs("#bdLogin").addEventListener("click", (e)=>{ if(e.target.id==="bdLogin") closeLogin(); });

  qs("#btnDoLogin").addEventListener("click", ()=>{
    const name = qs("#lName").value.trim();
    const wa   = qs("#lWa").value.trim();
    const pass = qs("#lPass").value;
    if(!name || !wa || !pass){
      alert("Isi Nama, WhatsApp, dan Password dulu.");
      return;
    }
    setUser({name, wa, pass});
    refreshLoginUI();
    alert("Login berhasil ‚úÖ");
    closeLogin();
  });

  qs("#btnLogout").addEventListener("click", ()=>{
    clearUser();
    refreshLoginUI();
    alert("Logout berhasil.");
    closeLogin();
  });

  // =======================
  // TYPING ANIMATION
  // =======================
  const typingText = "Halo Selamat Datang Di Website KivoPay, Semogaa Layanan Kami Memuaskan ‚ò∫Ô∏èüôè";
  const typingEl = qs("#typing");

  let i = 0;
  let dir = 1; // 1 typing, -1 deleting
  function tick(){
    if(dir === 1){
      i++;
      if(i >= typingText.length){
        dir = -1;
        setTimeout(tick, 900);
        renderTyping();
        return;
      }
    }else{
      i--;
      if(i <= 0){
        dir = 1;
        setTimeout(tick, 400);
        renderTyping();
        return;
      }
    }
    renderTyping();
    setTimeout(tick, dir===1 ? 40 : 26);
  }
  function renderTyping(){
    const shown = typingText.slice(0, i);
    typingEl.innerHTML = `<div>${shown}<span style="opacity:.85">‚ñç</span></div><small>Silakan login untuk mulai order.</small>`;
  }
  renderTyping();
  setTimeout(tick, 400);
</script>
</body>
</html>
